"use client";

import React from "react";
import {
  AnimatePresence,
  motion,
  useScroll,
  useTransform,
} from "framer-motion";
import { useSpinnerStore } from "@/stores/spinnerStore";

const Spinner = () => {
  const { scrollYProgress } = useScroll();
  const rotation = useTransform(scrollYProgress, [0, 1], [0, 360]);
  const spinnerStore = useSpinnerStore();

  return (
    <AnimatePresence>
      {spinnerStore.show && (
        <motion.svg
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          exit={{ opacity: 0 }}
          style={{ rotate: rotation }}
          width="92"
          height="83"
          viewBox="0 0 92 83"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <motion.path
            animate={{ fill: spinnerStore.color }}
            transition={{
              duration: 0.5,
              ease: "easeOut",
            }}
            id="Vector"
            d="M10.6272 52.0166C4.8737 51.9907 0.332934 47.4047 0 41.8159C0.02576 36.0189 4.93607 31.235 10.4825 30.8995C18.6505 30.9663 25.7316 40.8206 42.9921 40.8987L44.8409 40.7868L44.0126 39.3413C35.3154 24.1632 23.5459 22.8183 19.4045 15.5906C16.5054 10.5312 18.1729 4.2609 23.1942 1.33986C27.8566 -1.37253 34.4387 0.0989612 37.3377 5.15833C41.4792 12.386 36.7501 23.3286 45.4472 38.5068L46.2755 39.9523L46.9373 38.6036C55.5006 23.503 50.9301 12.1884 54.9568 5.02751C58.0182 0.35547 64.2263 -1.32868 69.2218 1.54742C74.2176 4.42352 75.5301 10.8875 73.0344 15.7123C68.6494 23.082 56.8391 24.1699 48.2758 39.2704L47.614 40.6191L49.1041 40.7159C66.3645 40.7935 73.205 31.0322 81.7315 30.8904C87.1262 31.1249 92.026 35.5027 91.9999 41.2997C91.9742 47.0971 87.4227 51.6723 81.8765 52.0074C73.7082 51.9406 66.2685 42.2949 49.008 42.2173L47.5179 42.1205L48.3462 43.566C57.0433 58.7441 68.813 60.0887 72.9545 67.3166C75.8535 72.3758 73.8271 78.8551 69.1646 81.5675C64.1435 84.4885 57.9201 82.8081 55.021 77.7488C50.8795 70.5209 55.6087 59.5787 46.9116 44.4006L46.0833 42.9551L45.0628 44.5124C36.4995 59.6125 41.4287 70.7187 37.4019 77.8795C34.3405 82.5519 27.7738 84.4447 22.7781 81.5683C18.1413 78.4837 16.4698 72.2281 19.3243 67.1947C23.3508 60.034 35.161 58.9457 43.7243 43.8456L44.7448 42.2883L42.896 42.4001C25.6355 42.3221 18.7952 52.0838 10.6272 52.0166Z"
          />
        </motion.svg>
      )}
    </AnimatePresence>
  );
};

export default Spinner;
